<!DOCTYPE html>
<html lang="lt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MokslaiGo</title>
  <link rel="stylesheet" href="./assets/tailwind.css">

<style>
  .active-nav { color:#2563eb; font-weight:600; border-bottom:2px solid #2563eb; padding-bottom:2px; }
</style>

<script type="module" src="./services/gate.js"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

  <!-- NAV BAR -->
  <app-nav></app-nav>


  <main class="flex-1 p-6 max-w-2xl mx-auto">
    <!-- Profile Info -->
    <section class="bg-white p-6 rounded shadow mb-6">
      <h2 class="text-3xl font-semibold mb-4" data-i18n="nav.profile">Profilis</h2>
      <div class="space-y-2">
        <p><strong data-i18n="auth.email">El. paštas</strong>: <span id="profile-email">—</span></p>
        <p><strong data-i18n="auth.registered">Registruota</strong>: <span id="profile-joined">—</span></p>
      </div>
    </section>

    <!-- Statistics -->
    <section class="bg-white p-6 rounded shadow">
      <h3 class="text-2xl font-medium mb-4">Statistika</h3>
      <ul class="list-disc pl-5 space-y-2">
        <li>Bandymų skaičius: <span id="stat-attempts">0</span></li>
        <li>Teisingų atsakymų skaičius: <span id="stat-correct">0</span></li>
        <li>Tikslumas: <span id="stat-accuracy">0%</span></li>
      </ul>
  <div class="text-center mt-4">
      <button
      id="clear-attempts-btn"
      class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"
    >
      Išvalyti bandymus
    </button>
    <button id="view-bookmarks" class="ml-4 px-3 py-1 bg-yellow-500 text-white rounded" data-i18n="profile.view_bookmarks">
      Peržiūrėti žymeles
    </button>

  </div>
<div class="mt-4 bg-yellow-100 border-l-4 border-yellow-500 p-4 text-yellow-800" role="alert">
    <p class="font-semibold">Atkreipkite dėmesį:</p>
    <p class="text-sm">Jūsų bandymai bus automatiškai ištrinti praėjus 30 dienų nuo jų sukurimo.</p>
  </div>
</section>

<!-- Find question by ID -->
<section class="bg-white p-6 rounded shadow mt-6">
  <h3 class="text-2xl font-medium mb-4" data-i18n="profile.find_by_id">Rasti klausimą pagal ID</h3>
  <form id="qidForm" class="flex gap-2">
    <input id="qidInput" type="text" class="flex-1 border rounded p-2"
           data-i18n-ph="profile.qid_placeholder"
           placeholder="Įklijuokite klausimo UUID (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)" />
    <button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700" data-i18n="profile.open_in_player">
      Atidaryti žaidime
    </button>
    <button type="button" id="qidPreviewBtn" class="px-3 py-2 border rounded" data-i18n="profile.preview">
      Peržiūra
    </button>
  </form>
  <div id="qidPreview" class="mt-3 text-sm text-gray-600"></div>
</section>

   <!-- Exam History -->
   <section id="examHistorySection" class="bg-white p-6 rounded shadow mt-6">
     <h2 class="text-2xl font-semibold mb-4" data-i18n="profile.exam_history">Egzaminų istorija</h2>
     <div id="examHistory" class="space-y-4">
       <!-- JS will inject each past exam here -->
     </div>

     <!-- ▼▼ NEW: Per-subtopic heatmap + trends + achievements ▼▼ -->
<hr class="my-6">

<h4 class="text-xl font-semibold mb-3" data-i18n="profile.per_subtopic">Rezultatai pagal potemes</h4>
<p class="text-sm text-gray-600 mb-2" data-i18n="profile.subtopic_hint">Spalva = tikslumas (raudona→žalia). Grafike – paskutinių 30 bandymų tendencija.</p>
<div id="subtopic-heatmap" class="grid grid-cols-2 sm:grid-cols-3 gap-3"></div>

<hr class="my-6">

<h4 class="text-xl font-semibold mb-3" data-i18n="profile.achievements">Pasiekimai</h4>
<div id="achievements" class="grid sm:grid-cols-3 gap-3">
  <div class="p-4 rounded bg-white border">
    <div class="text-sm text-gray-500" data-i18n="profile.daily_streak">Dienų serija</div>
    <div id="ach-streak" class="text-2xl font-bold">—</div>
  </div>
<div class="p-4 rounded bg-white border">
   <div class="text-sm text-gray-500" data-i18n="profile.fastest_perfect">Greičiausias tobulas egzaminas</div>
  <div id="ach-fastest" class="text-2xl font-bold">—</div>
  <div id="ach-fastest-date" class="text-xs text-gray-500">—</div>
</div>
  <div class="p-4 rounded bg-white border">
    <div class="text-sm text-gray-500" data-i18n="profile.total_exams">Iš viso egzaminų</div>
    <div id="ach-exam-count" class="text-2xl font-bold">—</div>
  </div>
</div>

<hr class="my-6">

<h4 class="text-xl font-semibold mb-3" data-i18n="profile.best_worst">Geriausios / Silpniausios potemės</h4>
<div id="best-worst" class="grid sm:grid-cols-2 gap-4">
  <div>
    <div class="text-sm text-gray-500 mb-1" data-i18n="profile.best_min10">Geriausios (min. 10 bandymų)</div>
    <ul id="best-list" class="list-disc pl-5 space-y-1 text-sm"></ul>
  </div>
  <div>
    <div class="text-sm text-gray-500 mb-1" data-i18n="profile.worst_min10">Silpniausios (min. 10 bandymų)</div>
    <ul id="worst-list" class="list-disc pl-5 space-y-1 text-sm"></ul>
  </div>
</div>
<!-- ▲▲ NEW end ▲▲ -->
   </section>
   <section id="bookmarksSection" class="bg-white p-6 rounded shadow mt-6">
   <h2 class="text-2xl font-semibold mb-4" data-i18n="profile.bookmarks">Žymelės</h2>
  <div id="bookmarkList" class="space-y-3">
    <!-- JS will inject clickable bookmark cards here -->
  </div>
</section>

</main>

<script type="module" src="./bootstrap.js"></script>
<script type="module" src="./script.js"></script>
<script type="module" src="./components/navbar.js"></script>
<script type="module" src="./profile.js"></script>
<!-- Exam summary modal -->
<dialog id="examModal" class="rounded-lg p-0 w-full max-w-md">
  <form method="dialog" class="p-4 border-b flex items-center justify-between">
    <h5 class="text-lg font-semibold" data-i18n="profile.exam_summary">Egzamino suvestinė</h5>
    <button class="px-2 py-1 rounded border" data-i18n="common.close">Uždaryti</button>
  </form>
  <div id="examModalBody" class="p-4"></div>
</dialog>
<!-- Bookmark modal (same look as exam modal) -->
<dialog id="bookmarkModal" class="rounded-lg p-0 w-full max-w-md">
  <form method="dialog" class="p-4 border-b flex items-center justify-between">
    <h5 class="text-lg font-semibold" data-i18n="profile.bookmark_modal">Žymelė</h5>
    <button class="px-2 py-1 rounded border" data-i18n="common.close">Uždaryti</button>
  </form>
  <div id="bookmarkModalBody" class="p-4"></div>
</dialog>



</body>
</html>
