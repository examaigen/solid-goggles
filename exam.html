<!DOCTYPE html>
<html lang="lt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mokslaigo</title>
  <!-- Tailwind CDN -->
  <link rel="stylesheet" href="./assets/tailwind.css">

    <!-- KaTeX (CSS + JS + auto-render) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js"></script>

  <style>
  .question-active {
    outline: 2px solid #2563eb; /* blue */
    outline-offset: 4px;
    border-radius: 10px;
    background: rgba(37,99,235,0.03);
  }
</style>
<style>
  .active-nav { color:#2563eb; font-weight:600; border-bottom:2px solid #2563eb; padding-bottom:2px; }
</style>
<script type="module" src="./services/gate.js"></script>
</head>
<body class="bg-gray-100 min-h-screen p-6">
<app-nav></app-nav>

  <h1 class="text-4xl font-bold text-gray-800 mb-8">Egzamino simuliacija</h1>

  <!-- class select-->
   <div class="mb-4">
   <label for="classSelect" class="block mb-1 font-medium">Pasirinkite klasę:</label>
   <select id="classSelect" class="w-full border border-gray-300 rounded px-3 py-2">
     <option value="">Visos klasės</option>
     <option value="12">12</option>
     <option value="11">11</option>
     <option value="10">10</option>
     <option value="9">9</option>
   </select>
 </div>

  <!-- 1) Subject dropdown -->
  <div class="mb-4">
    <label for="subjectSelect" class="block mb-1 font-medium">Pasirinkite dalyką:</label>
    <select id="subjectSelect" class="w-full border border-gray-300 rounded px-3 py-2">
      <option value="">Visi dalykai</option>
      <!-- populated by populateSubjects() -->
    </select>
  </div>

  <!-- 2) Subtopics (hidden until a subject is chosen) -->
  <div id="subtopicsContainer" class="mb-4 hidden">
    <p class="block mb-1 font-medium">Pasirinkite potemes:</p>
    <div id="subtopicsCheckboxes" class="grid grid-cols-2 gap-2 border border-gray-300 rounded p-2 h-32 overflow-y-auto">
      <!-- JS will inject a bunch of <label><input type="checkbox" …> Subtopic</label> here -->
    </div>
  </div>


  <div class="mb-4">
    <label for="testLengthSelect" class="block mb-1 font-medium">Pasirinkite testo trukmę:</label>
    <select id="testLengthSelect" class="w-full border border-gray-300 rounded px-3 py-2">
      <option value="short">Trumpas testas</option>
      <option value="half">Pusiau testas</option>
      <option value="full">Pilnas testas</option>
    </select>
  </div>

<div class="hidden">
  <!-- timeLimitInput removed in favor of fixed timers -->
</div>

  <button id="startBtn" disabled class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-6 rounded mb-6">
    Pradėti egzaminą
  </button>

<div id="examHeader" class="items-center justify-between mb-4 hidden">
  <div id="progressPill" class="text-sm px-2 py-1 rounded-full border">—</div>
  <div id="timer" class="text-lg font-medium"></div>
</div>

  <div id="examContainer" class="hidden space-y-6 mb-8">
    <form id="examForm" class="space-y-4"></form>
    <button id="submitBtn" type="button" class="bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-2 px-6 rounded">
      Pateikti atsakymus
    </button>
  </div>

<!-- Review drawer -->
<div id="review-drawer" class="hidden mb-4 border rounded p-3 bg-white">
  <div class="flex items-center justify-between">
    <strong>Peržiūra</strong>
    <div class="text-sm text-gray-500">
      <span id="review-count-unanswered">0</span> neatsakyta •
      <span id="review-count-marked">0</span> pažymėta
    </div>
  </div>
  <div id="review-list" class="mt-2 flex flex-wrap gap-2"></div>
</div>


  <div id="resultContainer" class="mt-8 bg-white p-6 rounded shadow"></div>
  <div id="reportContainer" class="mt-6 space-y-4 hidden"></div>


 <!-- Load Supabase client and module-based exam logic -->
<script type="module" src="./bootstrap.js"></script>
<script type="module" src="./script.js"></script>
<script type="module" src="./components/navbar.js"></script>
<script type="module" src="./config/renderMath.js"></script>
<script type="module" src="./exam.js"></script>

</body>
</html>